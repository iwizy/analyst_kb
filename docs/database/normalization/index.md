# Нормализация и денормализация

Нормализация и денормализация это управленческий баланс между целостностью данных и производительностью чтения.

## Нормализация

Нормализация уменьшает избыточность и предотвращает аномалии вставки, обновления и удаления.

Когда применять:

- транзакционные системы (OLTP);
- частые изменения данных;
- строгие требования к консистентности.

Плюсы:

- меньше дублирования;
- выше качество данных;
- проще поддерживать инварианты.

Минусы:

- больше JOIN в read-сценариях;
- сложнее тяжелая аналитика в online-контуре.

## Денормализация

Денормализация добавляет избыточность для ускорения чтения и упрощения аналитических запросов.

Когда применять:

- витрины и отчеты;
- read-heavy API;
- агрегаты для UI/дашбордов.

Плюсы:

- меньше JOIN;
- ниже latency на чтение;
- проще запросы в аналитике.

Минусы:

- риск рассинхронизации;
- усложнение write-процессов;
- требуется процесс reconciliation.

## Пример

Нормализованно:

- `customers(customer_id, full_name)`
- `orders(order_id, customer_id, amount)`

Денормализованная витрина:

- `orders_view(order_id, customer_id, customer_name, amount)`

## Рекомендованный подход

1. Стартовать с нормализованной модели.
1. Измерить узкие места на реальной нагрузке.
1. Денормализовать только горячие read-path.
1. Добавить проверку целостности и обновление витрин.

## Чек-лист решения

- есть ли измеримый bottleneck чтения;
- как будет поддерживаться согласованность денормализованных данных;
- как часто обновляются исходные данные;
- можно ли перенести read-нагрузку в DWH или кэш.

## Смежные материалы

- [Нормальные формы](normal-forms.md)
- [Проектирование модели данных](../data-modeling.md)
- [DWH и Data Lake](../dwh-and-data-lake.md)

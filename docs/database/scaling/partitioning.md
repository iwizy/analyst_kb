# Партицирование

Партицирование делит большую таблицу на логические части (партиции), чтобы ускорить запросы, упростить обслуживание и уменьшить объем сканирования.

## Когда применять

- таблицы очень большие и растут по времени/категории;
- большая часть запросов фильтрует данные по одному признаку;
- требуется быстро архивировать или удалять старые данные.

## Типы партицирования

- Range: диапазоны (например, по дате);
- List: фиксированные множества значений (например, регион);
- Hash: равномерное распределение;
- Composite: комбинация нескольких подходов.

## Пример (PostgreSQL, range)

```sql
CREATE TABLE events (
  event_id BIGINT,
  event_time TIMESTAMPTZ NOT NULL,
  payload JSONB
) PARTITION BY RANGE (event_time);

CREATE TABLE events_2026_01 PARTITION OF events
  FOR VALUES FROM ('2026-01-01') TO ('2026-02-01');

CREATE TABLE events_2026_02 PARTITION OF events
  FOR VALUES FROM ('2026-02-01') TO ('2026-03-01');
```

## Достоинства

- pruning: читаются только релевантные партиции;
- быстрое обслуживание данных (архив/удаление партиции);
- лучшее управление индексами на больших таблицах.

## Ограничения

- ошибки выбора partition key снижают эффект;
- сложнее администрирование и миграции;
- не решает проблему глобального write-bottleneck в одиночном узле.

## Практические рекомендации

- выбирать ключ партицирования по наиболее частому фильтру;
- контролировать размер и число партиций;
- автоматизировать создание новых партиций;
- проверять планы запросов на partition pruning.

## Смежные материалы

- [Шардирование](sharding.md)
- [Реплицирование данных](../replication.md)

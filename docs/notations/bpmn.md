# [BPMN](../glossary.md#abbr-009)

BPMN (Business Process Model and Notation) — стандарт для моделирования бизнес-процессов с ролями, событиями, задачами и потоками сообщений.

## Уровни сложности

### Базовый уровень

- понимать стартовые/промежуточные/завершающие события;
- моделировать пользовательские и сервисные задачи;
- применять XOR и AND шлюзы.

### Средний уровень

- использовать пулы/дорожки и message flow;
- выделять подпроцессы (collapsed/expanded);
- связывать BPMN с требованиями и [SLA](../glossary.md#abbr-079).

### Продвинутый уровень

- использовать event subprocesses и boundary events;
- проектировать исполняемые процессы (execution-ready);
- управлять библиотекой процессов и versioning.

## Элементы BPMN 2.0

### События

| Тип | Назначение |
| --- | --- |
| Start Event | запуск процесса |
| Intermediate Event | событие по ходу процесса (message, timer, error) |
| End Event | завершение процесса (success, error, terminate) |

### Задачи

| Тип задачи | Когда использовать |
| --- | --- |
| User Task | действие выполняет человек |
| Service Task | действие выполняет система |
| Script/Business Rule Task | автоматическая бизнес-логика |
| Manual Task | офлайн-операция |

### Шлюзы

| Шлюз | Назначение |
| --- | --- |
| Exclusive (XOR) | выбор одной ветви |
| Parallel (AND) | параллельный запуск ветвей |
| Inclusive (OR) | запуск одной или нескольких ветвей |

## Пример: оформление заказа

```kroki-plantuml
@startuml
|Покупатель|
start
:Оформить заказ;
|Интернет-магазин|
:Проверить корзину;
if (Данные корректны?) then (да)
  :Создать заказ;
  fork
    :Отправить в оплату;
  fork again
    :Резервировать товар;
  end fork
  if (Оплата и резерв успешны?) then (да)
    :Подтвердить заказ;
    |Покупатель|
    :Получить подтверждение;
  else (нет)
    :Отменить заказ;
    |Покупатель|
    :Получить отказ;
  endif
else (нет)
  |Покупатель|
  :Исправить данные;
endif
stop
@enduml
```

## Плюсы и минусы

| Плюсы | Минусы |
| --- | --- |
| стандарт OMG и понятная бизнесу нотация | можно перегрузить диаграмму деталями |
| хорошо показывает роли и handoff между ними | требует дисциплины именования |
| поддерживается BPM-платформами | сложные схемы трудно читать без декомпозиции |

## Когда выбирать [BPMN](../glossary.md#abbr-009)

- нужен детальный процесс со статусами и ответственностью ролей;
- требуется автоматизация процесса в BPM-движке;
- нужно согласование между бизнесом и IT.

## Сочетание с другими нотациями

- BPMN + [C4](../glossary.md#abbr-011): C4 показывает архитектурный контекст, BPMN — flow операций внутри контекста.
- BPMN + [UML](../glossary.md#abbr-092) Sequence: Sequence деталирует взаимодействие систем в одном шаге BPMN.
- BPMN + [ERD](../glossary.md#abbr-032): ERD уточняет данные, которые процесс создает и изменяет.

## Best practices

1. Один diagram = один процессный вопрос.
2. Называйте задачи глаголом: `Проверить лимит`, `Сформировать счет`.
3. Выносите сложные фрагменты в subprocess.
4. Не смешивайте message flow и sequence flow.
5. Подписывайте условия ветвления на шлюзах.

## Типичные ошибки и как избежать

| Ошибка | Как избежать |
| --- | --- |
| перегруженные схемы | декомпозируйте на уровни |
| отсутствуют роли | используйте lanes/pools |
| смешение бизнес- и технических шагов | делайте отдельные диаграммы |
| нет обработки исключений | добавьте error/timer events |

## Инструменты и форматы

- Camunda Modeler, Signavio, Bizagi, draw.io;
- экспорт: SVG/PNG/PDF, BPMN XML.
## Стандарты и источники

- BPMN 2.0.2: <https://www.omg.org/spec/BPMN/2.0.2>
- Camunda BPMN reference: <https://docs.camunda.org/manual/latest/reference/bpmn20/>
- BABOK (process modeling): <https://www.iiba.org/standards-and-resources/babok/>

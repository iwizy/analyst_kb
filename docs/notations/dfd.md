# DFD

DFD (Data Flow Diagram) показывает, какие данные входят в систему, как
обрабатываются и где хранятся. Это нотация для анализа потоков данных, а не
последовательности шагов процесса.

## Ключевые элементы

- External Entity: внешний источник/получатель данных.
- Process: преобразование данных.
- Data Store: хранилище данных.
- Data Flow: поток данных между объектами.

## Уровни детализации

- Context Diagram (Level 0): система как один процесс и внешние участники.
- Level 1/2: декомпозиция процесса на подпроцессы.

## Пример: обработка онлайн-заказа

### Контекст

```kroki-plantuml
@startuml
left to right direction
actor "Покупатель" as Customer
rectangle "Система заказов" as System
rectangle "Платежный шлюз" as Payment
rectangle "Склад" as Warehouse

Customer --> System : Заказ
System --> Payment : Данные оплаты
Warehouse --> System : Остатки и статус
System --> Customer : Статус заказа
@enduml
```

### Level 1

```kroki-plantuml
@startuml
left to right direction
actor "Покупатель" as Customer
database "D1 Заказы" as D1
database "D2 Остатки" as D2
rectangle "1. Принять заказ" as P1
rectangle "2. Проверить оплату" as P2
rectangle "3. Резервировать товар" as P3
rectangle "Платежный шлюз" as Payment

Customer --> P1 : Заявка
P1 --> D1 : Заказ
D1 --> P2 : Данные заказа
P2 --> Payment : Данные оплаты
Payment --> P2 : Статус оплаты
D1 --> P3 : Позиции заказа
P3 --> D2 : Запрос резерва
D2 --> P3 : Результат резерва
P3 --> Customer : Статус заказа
@enduml
```

## Как работать с DFD

1. Опишите границы системы и внешних участников.
1. Добавьте ключевые потоки данных и назовите их существительными.
1. Выполните декомпозицию до уровня, где понятны требования к интерфейсам.
1. Проверьте балансировку между уровнями (входы/выходы совпадают).

## Типичные ошибки

- смешение DFD с BPMN (действия вместо потоков данных);
- отсутствие хранилищ там, где данные реально сохраняются;
- слишком низкая детализация на верхнем уровне.

## Чек-лист качества

- Каждый поток данных имеет источник и получателя.
- Названия потоков отражают структуру данных.
- Для каждого процесса понятны вход, выход и бизнес-правило преобразования.

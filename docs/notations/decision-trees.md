# Деревья решений

Дерево решений визуализирует набор правил выбора и помогает сделать прозрачным процесс принятия решений.

## Уровни сложности

### Базовый уровень

- строить узлы условий и ветви решений;
- обозначать исходы (листья);
- читать путь решения от корня до листа.

### Средний уровень

- учитывать вероятности и стоимость ошибок;
- использовать дерево для бизнес-правил и [SLA](../glossary.md#abbr-079)-маршрутизации;
- валидировать правила на тестовых кейсах.

### Продвинутый уровень

- оптимизировать дерево по ожидаемой ценности;
- применять pruning и управление сложностью;
- связывать дерево с rule engine/DMN таблицами.

## Элементы

| Элемент | Назначение |
| --- | --- |
| Root node | стартовое условие |
| Decision node | проверка условия |
| Branch | исход условия |
| Leaf | конечное решение/действие |

## Пример: кредитный скоринг

```kroki-plantuml
@startuml
start
if (Credit score >= 700?) then (yes)
  if (DTI <= 40%) then (yes)
    :Approve;
  else (no)
    :Manual review;
  endif
else (no)
  if (Collateral available?) then (yes)
    :Manual review;
  else (no)
    :Reject;
  endif
endif
stop
@enduml
```

## Пример: маршрутизация инцидентов

- `Critical + payment impact` -> L3 on-call + immediate escalation.
- `High + no revenue impact` -> L2 in 30 min.
- `Medium` -> backlog with [SLA](../glossary.md#abbr-079) 24h.

## Плюсы и минусы

| Плюсы | Минусы |
| --- | --- |
| прозрачные правила решения | дерево быстро разрастается |
| удобно обсуждать с бизнесом | сложные зависимости трудно выразить |
| хорошо тестируется на кейсах | нужен контроль актуальности правил |

## Когда выбирать

- нужно формализовать decision logic;
- требуется объяснимая модель решения;
- необходимо согласовать маршрутизацию или скоринг.

## Как строить

1. Определите целевое решение и критерии.
2. Выпишите условия в порядке значимости.
3. Постройте ветви для каждого исхода.
4. Добавьте конечные решения и SLA/стоимость.
5. Проверьте на реальных кейсах и граничных условиях.

## Типичные ошибки и как избежать

| Ошибка | Как избежать |
| --- | --- |
| пересекающиеся условия | делайте условия взаимно исключающими |
| нет default-ветки | добавляйте fallback путь |
| сложные формулировки | разбивайте условие на простые предикаты |
| устаревшие правила | пересматривайте дерево по метрикам |

## Инструменты и форматы

- draw.io, Miro, DMN editors (Camunda Modeler), PlantUML;
- экспорт: SVG/PNG/PDF.
## Стандарты и источники

- Decision analysis fundamentals (Howard & Matheson)
- DMN standard (OMG): <https://www.omg.org/spec/DMN/>
- Camunda DMN guide: <https://docs.camunda.org/manual/latest/reference/dmn/>

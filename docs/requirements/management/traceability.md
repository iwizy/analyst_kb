# Трассировка требований

Трассировка требований обеспечивает видимость связей между целями бизнеса, требованиями, реализацией и проверкой. Это основа быстрого impact analysis и контроля полноты покрытия.

## Цель

- подтверждать, что реализуется именно требуемая ценность;
- выявлять лишнюю функциональность без источника;
- ускорять анализ влияния изменений;
- поддерживать аудит, комплаенс и управляемость релизов.

## Направления трассировки

- прямая: `бизнес-цель -> требования -> задачи -> тесты -> релиз`;
- обратная: `дефект/код/тест -> требование -> бизнес-цель`;
- двусторонняя: постоянная связность в обоих направлениях.

## Минимальная модель связей

- `BR -> UR/SR`;
- `UR/SR -> Feature/Epic/Task`;
- `UR/SR -> Test Case`;
- `CR -> затронутые требования/задачи/тесты`;
- `Defect -> нарушенное требование`.

## Двунаправленная схема (пример для сложного проекта)

```text
BG -> BR -> UR/SR -> Features -> Tasks -> Tests -> Code/Build
 ^                                                   |
 |---------------------------------------------------|
```

Расширенный вариант:

```kroki-plantuml
@startuml
left to right direction
rectangle "Business Goals" as BG
rectangle "Business Requirements" as BR
rectangle "User/System Requirements" as SR
rectangle "Features" as FE
rectangle "Tasks" as TK
rectangle "Test Cases" as TS
rectangle "Code/Build" as CB

BG --> BR
BR --> SR
SR --> FE
FE --> TK
SR --> TS
TK --> CB
TS --> CB

CB ..> TS : defects/coverage
TS ..> SR : validation feedback
SR ..> BR : scope impact
BR ..> BG : value alignment
@enduml
```

## Процесс внедрения

1. Определить объекты трассировки и типы связей.
1. Ввести стандарт ID и правила именования.
1. Создать RTM или эквивалент в ALM-инструменте.
1. Заполнить связи для high-impact требований.
1. Встроить обновление связей в Definition of Done.
1. Проверять покрытие перед релизом и после каждого CR.

## Пример RTM

| Requirement ID | Business Goal | Feature | Dev Task | Test Case | Code/PR | Статус |
| --- | --- | --- | --- | --- | --- | --- |
| BR-RET-001 | Сократить TAT возврата на 30% | FE-RET-04 | DEV-142 | QA-301 | PR-884 | In Progress |
| FR-RET-012 | Авторасчет суммы возврата | FE-RET-07 | DEV-211 | QA-355 | PR-913 | Passed |
| NFR-RET-004 | p95 <= 1 сек | FE-RET-07 | DEV-225 | PERF-022 | PR-918 | Planned |

## Шаблон RTM

| Requirement ID | Source Goal | Feature/Epic | Task | Test | Defect Link | Status | Owner |
| --- | --- | --- | --- | --- | --- | --- | --- |
| ... | ... | ... | ... | ... | ... | ... | ... |

## Автоматизация трассировки

### Jira + XRay (пример)

- типы сущностей: Requirement, Story, Test, Defect;
- обязательные ссылки: `implements`, `tests`, `affected by`;
- автоматические отчеты: coverage by requirement, failed tests by requirement.

### Polarion

- использовать встроенную trace matrix;
- настроить workflow для обязательных link types;
- включить baseline comparison в релизный процесс.

### IBM DOORS / DOORS Next

- матрицы трассировки между уровнями требований;
- impact analysis при изменении базовой версии;
- экспорт отчетов для аудита и CCB.

## Управление связями при изменениях

Правила обновления:

1. Любой `CR` обязан указывать затронутые требования и тесты.
1. При изменении требования пересматриваются все downstream links.
1. Связи без актуального владельца помечаются как risk.
1. Перед релизом выполняется контроль orphan-элементов.

Мини-checklist для impact analysis:

- какие бизнес-цели затронуты;
- какие требования меняются/удаляются;
- какие тесты устарели;
- какие задачи/команды зависят от изменения;
- требуется ли корректировка roadmap.

## Дашборды и визуальные отчеты

Рекомендуемые метрики:

- coverage: доля требований со связью к задачам и тестам;
- orphan count: количество несвязанных требований/тестов;
- stale links: доля связей без обновления в текущем релизе;
- impact analysis time: среднее время анализа CR;
- defect traceability: доля дефектов с обратной ссылкой на требование.

Практика визуализации:

- heatmap покрытия по доменам;
- список top orphan требований;
- динамика coverage по релизам;
- отчеты по влиянию CR.

## Типичные проблемы

- ручное ведение трассировки «по остаточному принципу»;
- избыточно сложная модель связей;
- отсутствие единых ID и стандартов ссылок;
- актуализация только перед аудитом.

## Практические рекомендации

- начинать с минимальной модели и расширять по мере зрелости;
- автоматизировать проверку обязательных links;
- назначить владельца качества трассировки;
- проверять orphan-элементы в каждом релизном цикле.

## Чек-лист перед релизом

- все требования релизного scope имеют тестовое покрытие;
- нет задач без исходного требования;
- все CR связаны с затронутыми артефактами;
- критичные дефекты имеют обратную связь на требования.

## Смежные материалы

- [Управление изменениями требований](change-management.md)
- [Поддержка актуальности требований](relevance.md)
- [Валидация и верификация требований](../validation.md)

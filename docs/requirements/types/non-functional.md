# Нефункциональные требования

Нефункциональные требования (NFR) задают характеристики качества и эксплуатационные ограничения системы. Они определяют, насколько надежно, безопасно и стабильно реализованные функции работают в реальном контуре.

## Цель

- зафиксировать измеримые критерии качества;
- снизить архитектурные и эксплуатационные риски;
- обеспечить проверяемость требований на тестах и в мониторинге.

## Ключевые категории NFR

### Производительность

- latency (p95/p99), throughput, concurrency;
- профили нагрузки и деградации.

Пример: `p95 ответа API <= 300 мс при 500 RPS`.

### Надежность и доступность

- uptime, MTTR, RTO/RPO;
- резервирование и сценарии восстановления.

Пример: `доступность сервиса 99.95% в месяц`.

### Безопасность

- аутентификация/авторизация;
- шифрование в канале и хранении;
- аудит критичных операций.

Пример: `MFA обязательна для финансовых операций`.

### Масштабируемость

- рост пользователей/запросов;
- требования к горизонтальному и вертикальному масштабированию.

Пример: `поддержка 3x роста нагрузки без даунтайма`.

### Эксплуатация и наблюдаемость

- логирование, метрики, трассировка;
- правила алертинга и инцидент-реакции.

Пример: `критическая ошибка формирует алерт <= 60 сек`.

### Сопровождаемость и комплаенс

- maintainability, testability;
- регуляторные требования к хранению/доступу/аудиту данных.

## Шаблон NFR

```text
NFR-XXX
Атрибут качества: <performance/security/...>
Метрика: <что измеряем>
Целевое значение: <порог>
Контекст: <нагрузка, среда, период>
Метод проверки: <тест/мониторинг>
Источник: <регуляторика/бизнес-риск/архитектура>
Ответственный: <роль>
```

## Процесс формулирования

1. Определить бизнес-риск, который контролирует NFR.
1. Выбрать метрику и единицу измерения.
1. Зафиксировать контекст измерения (нагрузка/среда/период).
1. Согласовать пороги с архитектурой и operations.
1. Связать NFR с FR, тестами и мониторингом.

## SLI/SLO/SLA

| Понятие | Что означает | Пример |
| --- | --- | --- |
| SLI | Измеряемый индикатор | Доля успешных запросов API |
| SLO | Целевое значение SLI | Успешность >= 99.9% за 30 дней |
| SLA | Договорное обязательство | При нарушении более 2 периодов подряд запускается план корректирующих мер |

## Таблица типовых метрик NFR

| Категория | Типовой показатель | Пример порога |
| --- | --- | --- |
| Performance | Время ответа API | `<= 2 сек` для 95% запросов |
| Availability | Доступность сервиса | `>= 99.9%` в месяц |
| Reliability | Восстановление после сбоя | `RTO <= 1 час` |
| Data durability | Потеря данных при аварии | `RPO <= 5 минут` |
| Security | Время реакции на критический инцидент | `<= 15 минут` до эскалации |

## Пример связки FR + NFR

- FR: оформление частичного возврата.
- NFR-RET-021: расчет суммы <= 1 сек (p95) при 200 одновременных операторах.
- NFR-RET-022: все операции возврата пишутся в audit log с хранением 12 месяцев.
- NFR-RET-023: доступность модуля возвратов 99.9% в месяц.

## План проверки NFR (пример)

| NFR ID | Тип проверки | Инструмент | Критерий прохождения |
| --- | --- | --- | --- |
| NFR-RET-021 | Performance test | k6/JMeter | p95 <= 1 сек |
| NFR-RET-022 | Security/Audit review | SIEM + manual check | Все события критичных действий в журнале |
| NFR-RET-023 | SRE monitoring | Prometheus/Grafana | Uptime >= 99.9% |

## Типичные ошибки

- «система должна быть быстрой» без метрики;
- NFR не привязан к конкретному сценарию;
- не указан контекст проверки;
- NFR не попадает в эксплуатационный мониторинг.

## Практические рекомендации

- формулировать NFR как контракт с измеримым порогом;
- закладывать NFR до детального архитектурного проектирования;
- проверять NFR на приемке и в production;
- связывать каждый критичный NFR с бизнес-риском.

## Инструменты

| Инструмент | Для чего использовать |
| --- | --- |
| k6 / JMeter | Нагрузочная проверка performance NFR |
| Prometheus / Grafana | Мониторинг SLI/SLO в эксплуатации |
| SIEM (Splunk/ELK и аналоги) | Аудит и безопасность, контроль событий |
| Jira / Azure DevOps | Связь NFR с FR, тестами и инцидентами |
| Confluence / Git docs | Хранение NFR-контрактов и revision history |

## Чек-лист качества

- есть метрика и целевой порог;
- указан контекст и метод проверки;
- назначен владелец контроля;
- NFR связан с конкретной функцией/сценарием;
- порог достижим для целевой архитектуры.

## Смежные материалы

- [Функциональные требования](functional.md)
- [Критерии качества требований](../quality.md)
- [Системные требования](../levels/system.md)
- [Управление изменениями требований](../management/change-management.md)

# Системные требования

Системные требования переводят пользовательские сценарии в инженерные обязательства: функции, интерфейсы, ограничения качества и правила обработки ошибок. На этом уровне требования становятся реализуемыми и тестируемыми.

## Цель

- детализировать поведение системы до уровня реализации и проверки;
- зафиксировать FR/NFR, контракты и ограничения;
- создать основу для архитектуры, разработки и QA.

## Состав системных требований

- функциональные требования (FR);
- нефункциональные требования (NFR);
- интерфейсные требования (API, события, форматы данных);
- правила данных и бизнес-правила;
- обработка ошибок, исключений и отказов;
- ограничения платформы и среды.

## Классы SR и их назначение

| Класс | Что фиксирует | Пример |
| --- | --- | --- |
| Behavior SR | Реакция системы на действие/событие | Блокировка пользователя после 5 неуспешных входов |
| Interface SR | Контракты API/событий/файлового обмена | `POST /refunds/calculate` |
| Data SR | Правила хранения, валидации, целостности | Уникальность `orderId` в контуре возвратов |
| Operational SR | Мониторинг, алертинг, аудит | Алерт за 60 сек при критической ошибке |

## Стандартный шаблон

```text
SR-XXX
Источник: <UR/BR/регуляторика>
Описание: <поведение системы>
Предусловия: <когда применяется>
Входы: <данные/события>
Выходы: <результат>
Ошибки/исключения: <что делаем при сбое>
Ограничения: <технические/организационные>
Критерий проверки: <как подтверждаем>
```

## Процесс формирования

1. Декомпозировать UR в атомарные функции и правила.
1. Описать входы/выходы/состояния и пограничные условия.
1. Добавить NFR для критичных потоков.
1. Уточнить API/данные/интеграции и контрактные ограничения.
1. Проверить тестируемость и непротиворечивость.

## Пример

```text
SR-014
Источник: UR-041
Описание: система блокирует учетную запись после 5 неуспешных попыток входа в течение 15 минут.
Предусловия: пользователь активен, MFA не отключена политикой домена.
Входы: события неуспешной аутентификации.
Выходы: статус учетной записи = Blocked; событие аудита.
Ошибки/исключения: при недоступности IdP применяется локальный rate limit.
Ограничения: синхронизация с внешним IdP не реже 1 раза в минуту.
Критерий проверки: блокировка на 5-й попытке, автоматическая разблокировка через 30 минут.
```

## Пример SR + API контракт

| Поле | Пример |
| --- | --- |
| SR ID | SR-RET-022 |
| Контракт | `POST /refunds/calculate` |
| Вход | `orderId`, `positions[]`, `reasonCode` |
| Выход | `refundAmount`, `currency`, `rules[]` |
| Ошибка | `422 INVALID_REASON`, `503 BILLING_UNAVAILABLE` |
| NFR | p95 <= 1 сек при 100 RPS |

## Примеры SR по доменам

| Домен | Пример SR | Проверка |
| --- | --- | --- |
| Финтех | Сервис платежей выполняет retry c экспоненциальной задержкой и идемпотентностью по `paymentId` | Контрактные тесты + отказоустойчивый стенд |
| E-commerce | Модуль возвратов рассчитывает компенсацию с учетом скидок и комиссий | Functional + performance test |
| Госуслуги | Шлюз межведомственного обмена обрабатывает входящие статусы не дольше 10 минут | Интеграционный SLA-тест |

## Матрица верификации SR

| SR ID | Тип проверки | Артефакт проверки |
| --- | --- | --- |
| SR-014 | Functional test | TC-AUTH-011..015 |
| SR-RET-022 | API contract test | CT-RET-v2 |
| NFR-RET-004 | Performance test | PERF-RET-002 |

## SR в Agile, Waterfall и гибриде

### Agile

- детализируются итеративно перед реализацией;
- сильная связка с Definition of Ready и Three Amigos;
- изменения должны быстро отражаться в тестах и контрактах.

### Waterfall

- формируются заранее в составе SRS;
- изменения после baseline проходят через CR;
- акцент на формальной полноте и прослеживаемости.

### Гибрид

- high-level SR фиксируются заранее;
- детальные SR уточняются по релизным инкрементам;
- актуальность проверяется на release review.

## Типичные ошибки

- расплывчатые формулировки («быстро», «надежно», «удобно»);
- отсутствие негативных сценариев;
- дублирование требования в разных местах;
- фиксация технологии без обоснования на уровне SR.

## Практические рекомендации

- каждое SR связывать с UR/BR и ID источника;
- фиксировать критерий проверки одновременно с требованием;
- отделять системное поведение от деталей реализации;
- проводить совместный review BA + Tech Lead + QA.

## Инструменты

| Инструмент | Для чего использовать |
| --- | --- |
| Jira / Azure DevOps | Ведение SR и связей с задачами и тестами |
| Swagger / OpenAPI | Документирование и проверка API-контрактов |
| Postman / SoapUI | Тестирование интерфейсных SR |
| XRay / Zephyr | Проверка покрытия SR тест-кейсами |

## Чек-лист качества

- формулировка однозначна и тестируема;
- определены входы/выходы и ошибки;
- есть связь с UR/BR;
- учтены релевантные NFR;
- требование включено в RTM.

## Смежные материалы

- [Пользовательские требования](user.md)
- [Функциональные требования](../types/functional.md)
- [Нефункциональные требования](../types/non-functional.md)
- [Валидация и верификация требований](../validation.md)

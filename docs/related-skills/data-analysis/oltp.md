# [OLTP](../../glossary.md#abbr-060)

OLTP (Online Transaction Processing) это контур оперативных транзакций, где критичны целостность данных, низкая задержка и корректная обработка конкурентных операций.

## Уровни сложности

### Базовый уровень

- понимать, что OLTP ориентирован на `insert/update/delete`;
- учитывать ACID-требования;
- фиксировать критичные транзакции в требованиях.

### Средний уровень

- описывать инварианты бизнес-процесса;
- учитывать блокировки, идемпотентность и повторы;
- задавать [SLA](../../glossary.md#abbr-079) по latency и error rate.

### Продвинутый уровень

- проектировать требования к консистентности в распределенных сценариях;
- учитывать деградацию и fallback-пути;
- связывать OLTP-требования с интеграционными паттернами.

## Где важно для аналитика

| Сценарий | Критичный инвариант |
| --- | --- |
| Платеж | нельзя провести двойное списание |
| Заказ | нельзя подтвердить заказ без резерва |
| Возврат | нельзя вернуть больше оплаченной суммы |

## Мини-шаблон транзакционного требования

| Поле | Пример |
| --- | --- |
| Operation | подтверждение оплаты |
| Preconditions | заказ в статусе `pending_payment` |
| Atomicity rule | обновить платеж и заказ в одной транзакции |
| Idempotency | повтор с тем же ключом не создает дубль |
| SLA | p95 <= 300 ms |

## Типичные ошибки

- аналитические запросы в транзакционной базе в пике;
- отсутствие требований к повторной отправке запроса;
- неописанные сценарии частичного отказа;
- смешение бизнес- и технических статусов.

## Кросс-ссылки

- [OLAP](olap.md)
- [Идемпотентность](../../integrations/api-design/idempotency.md)
- [Консистентность и распределение](../../database/consistency-and-distribution.md)

## Источники

- Designing Data-Intensive Applications.
- PostgreSQL transaction docs: <https://www.postgresql.org/docs/current/tutorial-transactions.html>

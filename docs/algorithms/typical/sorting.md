# Алгоритмы сортировки

Сортировка упорядочивает данные, после чего ускоряются поиск, агрегация,
ранжирование и подготовка отчетов. Для аналитика важны критерии выбора:
объем данных, стабильность, память и предсказуемость времени.

## Когда нужна сортировка

- подготовка top-N выдачи;
- дедупликация и группировка;
- построение отчетных витрин;
- оптимизация последующего поиска.

## Сравнение популярных алгоритмов

| Алгоритм | Средняя сложность | Худший случай | Стабильность | Когда подходит |
| --- | --- | --- | --- | --- |
| Bubble sort | `O(n^2)` | `O(n^2)` | Да | учебные примеры |
| Insertion sort | `O(n^2)` | `O(n^2)` | Да | почти отсортированные данные |
| Merge sort | `O(n log n)` | `O(n log n)` | Да | предсказуемое время, важна стабильность |
| Quick sort | `O(n log n)` | `O(n^2)` | Нет | быстрая сортировка общего назначения |
| Heap sort | `O(n log n)` | `O(n log n)` | Нет | ограниченная память, нужен worst-case |
| Timsort (Python/Java) | `O(n log n)` | `O(n log n)` | Да | производственная сортировка смешанных данных |

## Практический выбор алгоритма

```kroki-plantuml
@startuml
start
if (Нужна стабильность?) then (Да)
  if (Данные почти отсортированы?) then (Да)
    :Insertion или Timsort;
  else (Нет)
    :Merge sort или Timsort;
  endif
else (Нет)
  if (Важен worst-case?) then (Да)
    :Heap sort;
  else (Нет)
    :Quick sort;
  endif
endif
stop
@enduml
```

## Пример: стабильная сортировка заказов

```python
orders = [
    {"id": 1, "priority": 2, "created_at": "2026-02-09T09:00:00"},
    {"id": 2, "priority": 1, "created_at": "2026-02-09T08:00:00"},
]

result = sorted(orders, key=lambda o: (o["priority"], o["created_at"]))
```

## Типичные ошибки

- использование `O(n^2)` на больших объемах без необходимости;
- игнорирование стабильности, когда важен исходный порядок равных ключей;
- сортировка "на каждом шаге" вместо одной финальной операции.

## Чек-лист качества

- Выбран алгоритм с учетом объема и ограничений памяти.
- Известна потребность в стабильности.
- Сортировка выполняется минимально необходимое число раз.

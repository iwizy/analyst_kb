# Масштабирование сервисов

Масштабирование - способность системы выдерживать рост нагрузки при сохранении SLA.

## Базовые модели

| Тип | Суть | Когда применять |
| --- | --- | --- |
| Vertical scaling | больше ресурсов одному узлу | быстрый рост на старте, stateful сервисы |
| Horizontal scaling | больше инстансов | stateless сервисы и web/API нагрузка |
| Functional scaling | разделение по доменам/функциям | рост продукта и команд |

## Масштабирование данных

- `Partitioning`: деление таблиц на секции (по дате, диапазону, hash).
- `Sharding`: разбиение данных по нескольким узлам/БД.
- `Replication`: read scaling и отказоустойчивость.

## Алгоритм выбора

1. Найти bottleneck по метрикам (CPU, I/O, lock waits, queue lag).
1. Сначала устранить алгоритмические проблемы и N+1.
1. Применить подходящее scaling-решение.
1. Проверить на нагрузочном тесте близком к production.

## Типичные ошибки

- масштабировать сервис до устранения неэффективного SQL/алгоритма;
- шардировать слишком рано без операционной зрелости;
- отсутствие тестов на hot partitions и skew.
